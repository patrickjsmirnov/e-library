"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function e(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw o}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();!function(){function e(e){var t=document.getElementsByClassName("modal")[0];document.getElementsByClassName("modal__book_title")[0].innerHTML=e+" ?",t.style.display="block"}function t(){m.title.value="",m.author.value="",m.year.value="",m.pages.value="",d.dataset.edit="false"}function a(e,t){e.removeFromLocalStorage(),t.addToLocalStorage()}function n(e){return[e.querySelector(".title").innerHTML,e.querySelector(".author").innerHTML,+e.dataset.year,+e.dataset.pages]}function r(e,t,a,n,r){e.querySelector(".title").innerHTML=t,e.querySelector(".author").innerHTML=a,e.dataset.year=n,e.dataset.pages=r}function o(){return[m.title.value.trim().replace(/\s+/g," "),m.author.value.trim().replace(/\s+/g," "),+m.year.value,+m.pages.value]}function s(e,t){if(!t.parentElement.lastElementChild.classList.contains("add_books__message")){var a=document.createElement("span");a.innerHTML=e,a.className="add_books__message",t.parentElement.appendChild(a)}}function l(e){e.parentElement.lastElementChild.classList.contains("add_books__message")&&e.parentNode.removeChild(e.parentNode.lastChild)}function i(e,t,a,n){var r=!0;return""==e&&(s("Введите название",m.title),r=!1),""==t&&(s("Введите автора",m.author),r=!1),""==a&&(s("Введите год издания",m.year),r=!1),""==n&&(s("Введите кол-во страниц",m.pages),r=!1),r}function c(e,t,a,n){m.title.value=e,m.author.value=t,m.year.value=a,m.pages.value=n,m.title.focus()}for(var u=function(){function e(t,a,n,r){_classCallCheck(this,e),this.title=t,this.author=a,this.year=n,this.pages=r}return _createClass(e,[{key:"show",value:function(){var e=document.createElement("div");e.className="books_catalog__item",e.innerHTML='\n                        <p class="title">'+this.title+'</p>\n                        <p class="author">'+this.author+'</p>\n                        <i class="delete fa fa-trash"></i>\n                        <i class="edit fa fa-pencil"></i>',f.insertBefore(e,f.firstChild),e.dataset.year=""+this.year,e.dataset.pages=""+this.pages}},{key:"addToLocalStorage",value:function(){localStorage.setItem(this.id,JSON.stringify(this))}},{key:"removeFromLocalStorage",value:function(){delete localStorage[this.id]}},{key:"id",get:function(){return""+this.title+this.author+this.year+this.pages}}]),e}(),d=document.getElementsByClassName("add_books__form")[0],m=document.getElementsByClassName("add_books__form")[0].elements,f=document.getElementsByClassName("books_catalog")[0],y=void 0,g=document.getElementsByClassName("modal")[0],h=document.getElementsByClassName("modal__close")[0],v=document.getElementsByClassName("modal__yes")[0],p=document.getElementsByClassName("modal__no")[0],_=0;_<localStorage.length;_++){var E=JSON.parse(localStorage.getItem(localStorage.key(_)));(E=new u(E.title,E.author,E.year,E.pages)).show()}document.addEventListener("click",function(s){if(s.target.classList.contains("btnForm")){var f=o(),_=_slicedToArray(f,4),E=_[0],k=_[1],C=_[2],L=_[3];if(!i(E,k,C,L))return 0;var S=new u(E,k,C,L);if("true"==d.dataset.edit){var b=n(y),T=_slicedToArray(b,4),N=T[0],w=T[1],B=T[2],A=T[3];r(y,E,k,C,L),a(new u(N,w,B,A),S)}else void 0==localStorage[S.id]&&(S.addToLocalStorage(),S.show());t(),d.dataset.edit="false",y=void 0}if(s.target.classList.contains("delete")){var H=s.target.parentElement,M=n(H),q=_slicedToArray(M,4),O=q[0],F=""+O+q[1]+q[2]+q[3];e(O),h.onclick=function(){return g.style.display="none"},p.onclick=function(){return g.style.display="none"},v.onclick=function(){g.style.display="none",delete localStorage[F],H.style.display="none"},window.onclick=function(e){e.target==g&&(g.style.display="none")}}if(s.target.classList.contains("edit")){l(m.title),l(m.author),l(m.year),l(m.pages);var I=s.target.parentElement,j=n(I),J=_slicedToArray(j,4);c(J[0],J[1],J[2],J[3]),d.dataset.edit="true",y=I}}),m.title.addEventListener("focus",function(e){return l(m.title)}),m.author.addEventListener("focus",function(e){return l(m.author)}),m.year.addEventListener("focus",function(e){return l(m.year)}),m.pages.addEventListener("focus",function(e){return l(m.pages)})}();